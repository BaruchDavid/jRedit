<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layouts/main_layout :: head(title = ' Login')}">
</head>
<body>

    <nav th:replace="~{layouts/main_layout :: nav}"></nav>
    <div th:replace="~{layouts/main_layout :: jumbotron}"></div>
    <!-- profile -->
<!--     th:if="${success}" -->
    <div id="profile" class="container">
    	<div th:if="${success}" id="displayMessage" class="alert alert-success" role="alert" >
           <p th:text="${redirectMessage}">Welcome to our store!</p>
        </div>
        <div class="row">
            <ul class="nav">
                <li class="nav-item">
                    <a class="nav-link" href="#">Posts</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Comments</a>
                </li>  
                <!-- TEST IM BACKEND NICHT VERGESSEN ZU IMPLEMENTIEREN !!!! -->              
 				<li class="nav-item dropdown" sec:authorize="isAuthenticated()" th:if="${userDto.getEmail() == userContent.getEmail()}"> 
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					  Preferences
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdown">
					  <a class="dropdown-item" th:href="@{'/profile/private/me/' + ${userDto.getEmail()}}">Me</a>
					  <a class="dropdown-item" th:href="@{'/profile/private/me/' + ${userDto.getEmail()}} + '/password'">Change password</a>
					  <a class="dropdown-item" th:href="@{'/profile/private/me/update/email/' + ${userDto.getEmail()}}">Change email</a>
					  <div class="dropdown-divider"></div>
					  <a class="dropdown-item" href="#">Ask admin</a>
					</div>
				</li>
 
            </ul>
        </div>
     
       <!--  angemeldeter User: 
        <p class="body" th:text="${userDto.getEmail()}"></p>
        <br>
        angeklickter User:
        <p class="body" th:text="${userContent.getEmail()}"></p> -->
        <div class="row">
            <div class="col">
	            <div class="row link" th:each="link : ${posts}">
		                <p class="title">
		                    <a class="title " th:href="@{'/links/link/' + ${link.getLinkId()}}" th:text="${link.getTitle()}">Title Goes Here</a>
		                    <span class="domain">
		                    (<a th:href="${link.url}" th:text="${link.getHoster()}" target="_blank"></a>)
		                    </span>
		                </p>
		                <p class="tagline ">submitted                    
		                    <time th:title="${link.getCreationDate()}" th:datetime="${link.getCreationDate()}"
		                        class="live-timestamp" th:text="${link.getElapsedTime()}"></time> by
		                    <a th:href="@{'/profile/public/' + ${link.getUser().getEmail()}}" class="author" th:text="${link.getUser().getAliasName()}">rka</a>
		                </p>
		                <p>
		                    <a th:href="@{'/links/link/' + ${link.getLinkId()} + '#comments'}" class="comments"
		                        th:text="|${link.getCommentCount()} comments|"><i class="fas fa-comments"></i> 0 comments</a>
		                    <a href="/jReditt/connect/facebook" class="share"><i class="fas fa-share-square"></i> share</a>
		                </p>
	            </div>
	        </div> 
           <!--  Right Side -->
            <div class="col-3 offset-1">
                <div class="row">
                    <div class="card col-12">
                        <img class="card-img-top" id="profilePic" src="#"  alt="Card image cap">
                        <div class="card-body">
                            <a href="submit.html"><button type="button" class="btn btn-primary btn-lg btn-block">New Post</button></a>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="card col-12">
                        <div class="card-body">
                            <h5 class="card-title">Your Information</h5>
                            <p class="card-text">
                                <p id="userName" th:text="${userContent.getFullName()}">Username: </p>
                                <p id="userSince" th:text="${'User since: ' + userSince}">User Since: </p>
                                <p id="linkSize" th:text="${'Links: ' + #lists.size(posts)}">Links: </p>
                                <p id="commentSize" th:text="${'Comments: ' + #lists.size(comments)}">Comments: </p>         	
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="card col-12">
                        <h5 id="linkHisTitle" class="card-title recentLinks">Recent Links Clicked</h5>
                        <ul id="linkHis" class="list-group list-group-flush">
                        </ul>
                    </div>
                </div>
            </div>
			
        </div> 
    
    </div><!-- // profile -->
    <input type="hidden" id="user" name="user" th:value="${userContent.getEmail()}">
    <div th:replace="~{layouts/main_layout :: div#bootstrap_func}"></div>
	<script th:src="@{/js/user.js}"></script>
</body>

</html>